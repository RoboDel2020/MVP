<style>
    .logout_btn {
        font-size: 15px;
        transition: ease-in all 0.5s;
        background-color: #f5b707;
        color: #fff;
        position: fixed;
        right: 20px;
        top: 10px;
        padding: 6px 13px;
    }

        .logout_btn:hover {
            background-color: #232323;
            color: #fff;
            transition: ease-in all 0.5s;
            border-radius: 26px;
        }

    .logo_text {
        color: #f5b707;
        font-size: 30px;
        font-weight: bold;
        margin-top: 5px
    }
</style>
<div>
    <h1 class="logo_text"><a href="javascript:GoMainMenu()">RoboDel<a/></h1>
    <button class="logout_btn" type="button" onclick="Logout()">Logout</button>
    <hr>
</div>
<br>
<button class="btn btn-success" type="button" style="float: right;" onclick="AddOrder()">Add Order</button>
<br>

<h1>All Orders</h1>

<br>
<table class="table table-striped">
    <tr>
        <th><b>Order ID</b></th>
        <th><b>Received At</b></th>
        <th><b>Estimated Pickup Time</b></th>
        <th><b>Ready for Pickup</b></th>
        <th><b>Status</b></th>
        <th><b>Restaurant</b></th>
        <th><b>Customer</b></th>
    </tr>
    @foreach (Order order in ViewBag.allOrders)
    {
        <tr>
            <td><a href="javascript:GetOrderDetails('@order.ID.ToString()')" style="color: blue">@order.ID</a></td>
            <td>@order.DateTime</td>
            <td>@order.PickupTime</td>

            @if (@order.ReadyForPickup)
            {
                <td>Yes</td>
            }
            else
            {
                <td>No</td>
            }
            <td>@order.Status</td>
            <td><a href="javascript:GetRestaurantDetails('@order.Restaurant.Email')" style="color: blue">@order.Restaurant.Name</a></td>
            <td><a href="javascript:GetCustomerDetails('@order.Customer.ID.ToString()')" style="color: blue">@order.Customer.FirstName @order.Customer.LastName </a></td>
        </tr>
    }
</table>
<input type="button" value="Test Maps" class="register_btn" onclick="testAPI()" style="width: 200px" />

<script>function GetRestaurantDetails(restaurantEmail) {
        $.ajax({
            type: "POST",
            url: "/ViewRestaurant/GoToViewRestaurant",
            async: true,
            dataType: "json",
            data: { restaurantEmail: restaurantEmail },
            success: function (data) {
                if (data.errMsg != "") {
                    alert(String(data.errMsg));
                } else {
                    window.location.href = '/ViewRestaurant/Index';
                }
            },
            error: function () {
                return "error";
            }
        });
    }

    function GetCustomerDetails(customerID) {
        $.ajax({
            type: "POST",
            url: "/ViewCustomer/GoToViewCustomer",
            async: true,
            dataType: "json",
            data: { customerID: customerID },
            success: function (data) {
                if (data.errMsg != "") {
                    alert(String(data.errMsg));
                } else {
                    window.location.href = '/ViewCustomer/Index';
                }
            },
            error: function () {
                return "error";
            }
        });
    }

    function GetOrderDetails(orderID) {
        $.ajax({
            type: "POST",
            url: "/ViewOrder/GoToViewOrder",
            async: true,
            dataType: "json",
            data: { orderID: orderID },
            success: function (data) {
                if (data.errMsg != "") {
                    alert(String(data.errMsg));
                } else {
                    window.location.href = '/ViewOrder/Index';
                }
            },
            error: function () {
                return "error";
            }
        });
    }
    function Logout() {
        $.ajax({
            type: "POST",
            url: "/Login/Logout",
            async: true,
            dataType: "json",
            data: {},
            success: function (data) {
                window.location.href = '/Login/Index';
            }
        });
    }

    function GoMainMenu() {
        $.ajax({
            type: "POST",
            url: "/MainMenu/GoMainMenu",
            async: true,
            dataType: "json",
            data: {},
            success: function (data) {
                if (data.errMsg != "") {
                    alert(String(data.errMsg));
                } else {
                    window.location.href = '/MainMenu/Index';
                }
            },
            error: function () {
                return "error";
            }
        });
    }
    function AddOrder() {
        $.ajax({
            type: "POST",
            url: "/AddOrder/GoToAddOrder",
            async: true,
            dataType: "json",
            data: {},
            success: function (data) {
                window.location.href = '/AddOrder/Index';
            }
        });
    }

    function testAPI() {
        

        @*const body = '{"coordinates":[[43.0588647918687, -89.40034963890459],[43.067906818785985, -89.41057272700718]]}';*@


        var request = new XMLHttpRequest();

        request.open('GET', 'https://api.openrouteservice.org/v2/directions/foot-walking?api_key=5b3ce3597851110001cf62488303e1e1bcb64deb91105af7032e30d4&start=-89.43481627077286,43.08957898010592&end=-89.40057767677146,43.05885104655657');

        request.setRequestHeader('Accept', 'application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8');

        request.onreadystatechange = function () {
            if (this.readyState === 4) {
                @*console.log('Status:', this.status);*@
                @*console.log('Headers:', this.getAllResponseHeaders());*@
                @*console.log('Body:', this.responseText);*@
                const bodyJson = JSON.parse(this.responseText);
                console.log('Distance in km:', bodyJson.features[0].properties.summary.distance/1000);
                console.log('Duration in minutes:', bodyJson.features[0].properties.summary.duration/60);
            }
        };

        request.send();
    }
        
    </script>

</script>
<!-- end contact -->
<!-- Javascript files-->
<script src="~/js/jquery.min.js"></script>
<script src="~/js/popper.min.js"></script>
<script src="~/js/bootstrap.bundle.min.js"></script>
<script src="~/js/jquery-3.0.0.min.js"></script>
<script src="~/js/plugin.js"></script>
<!-- sidebar -->
<script src="~/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="~/js/custom.js"></script>
<script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>

